<template>
	<div>
		<div class="operate mtb10">
			<el-button class="mr25 ml30 pad1025" size="small" type="primary" @click="goBack">返回</el-button>
			<el-button class="mr25 pad1025" size="small" type="primary" @click="save('addForm')">保存</el-button>
			<el-button class="mr25 pad1025" size="small" type="primary" @click="resetForm('addForm')">重置</el-button>
		</div>
		<div class="addForm">
			<el-form :inline="true" :model="addForm" ref="addForm" :rules="rules" class="form-style" label-position="right" :label-width="formLabelWidth">
				<el-row>
					<el-col :span="8">
						<el-form-item label="工序:" prop="operation">
							<el-input v-model="addForm.operation"></el-input>
						</el-form-item>
					</el-col>
				</el-row>
				<el-row>
					<el-col :span="24">
						<el-form-item label="描述:" prop="operationDes">
							<el-input maxlength="80" show-word-limit type="textarea" :autosize="{ minRows: 2, maxRows: 4}" v-model="addForm.operationDes"> </el-input>
						</el-form-item>
					</el-col>
				</el-row>
				<el-row>
					<el-col :span="24">
						<el-tabs v-model="activeName" type="card">
							<el-tab-pane label="基础信息" name="first">
								<el-row>
									<el-col :span="24">
										<el-form-item label="状态:" prop="status">
											<el-select v-model="addForm.status">
												<el-option
													v-for="item in status"
													:key="item.value"
													:label="item.label"
													:value="item.value">
												</el-option>
											</el-select>
										</el-form-item>
									</el-col>
								</el-row>
								<el-row>
									<el-col :span="24">
										<el-form-item label="报告步骤:" prop="reportingStep">
											<el-input v-model="addForm.reportingStep"> </el-input>
										</el-form-item>
									</el-col>
								</el-row>
								<el-row>
									<el-col :span="24">
										<el-form-item label="设备组:" prop="resourceGroup" >
											<el-select v-model="addForm.resourceGroup">
												<el-option
													v-for="item in resourceGroup"
													:key="item.resourceGroup"
													:label="item.resourceGroup"
													:value="item.resourceGroup">
												</el-option>
											</el-select>
										</el-form-item>
									</el-col>
								</el-row>
								<el-row>
									<el-col :span="24">
										<el-form-item label="上岗证:" prop="certOperation" >
											<el-select v-model="addForm.certOperation" >
												<el-option
													v-for="item in certOperation"
													:key="item.value"
													:label="item.label"
													:value="item.value">
												</el-option>
											</el-select>
										</el-form-item>
									</el-col>
								</el-row>
							</el-tab-pane>
							<el-tab-pane label="自定义数据" name="second">
								数据字段，数据属性
							</el-tab-pane>
						</el-tabs>
					</el-col>
				</el-row>
			</el-form>
		</div>
	</div>
</template>

<script>
	import {saveOperation, getAllResourceGroup} from '../../../api/operation.maintain.api.js'
	export default {
		name:'add-operation-maintain',
		data() {
			return {
				activeName:'first',
				formLabelWidth:'120px',
				rules: {
				},
				addForm: {
					operation:'',
					operationDes:'',
					status:'',
					certOperation:'',
					reportingStep:'',
					resourceGroup:'',
				},
				status:[{
					label:'已启用',
					value:true
				},{
					label:'未启用',
					value:false
				}],
				resourceGroup:[],
				certOperation:[],
			}
		},
		created() {
			getAllResourceGroup().then(data => {
				this.resourceGroup = data.data.data
			})
		},
		methods: {
			goBack() {
				this.$router.push({path:'/operationMaintain/operationMaintain'})
			},
			resetForm(formName) {
				this.$refs[formName].resetFields();
			},
			save(formName){
				this.$refs[formName].validate((valid) => {
					if (valid) {
						// let params = this.addForm
						let params = {
							createList:[this.addForm]
						}
						saveOperation(params).then(data => {
							if(data.data.message == 'success'){
								this.$message({
									type: 'success',
									message: '保存成功!'
								});
								setTimeout(()=>{
									this.$router.push({path:'/operationMaintain/operationMaintain'})
								},1000)
							}
						})
					} else {
						console.log('error submit!!');
						return false;
					}
				});
			},
		}
	}
</script>

<style scoped lang="scss">
	.operate {
		background: #FFFFFF;
		padding: 10px;
	}
	.addForm {
		background: #FFFFFF;
		padding: 10px;
		.dec {
			width: 756px !important;
		}
	}
	.el-textarea /deep/ .el-textarea__inner{
		width: 300px;
	}
</style>
